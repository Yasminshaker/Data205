---
title: "Untitled"
author: "yasmin"
date: "2023-11-08"
output: html_document
---

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidyverse)
```



```{r, message=FALSE}
processdata <- function(year)
  { zip_url <- paste0("https://aqs.epa.gov/aqsweb/airdata/annual_aqi_by_county_", year, ".zip")
  temp <- tempfile(fileext = ".zip")
  download.file(zip_url, temp)
  unzip(temp, exdir = tempdir())
  csv_file <- file.path(tempdir(), paste0("annual_aqi_by_county_", year, ".csv"))
  data <- readr::read_csv(csv_file)
  mrow <- data %>% filter(State == "Maryland" & County == "Montgomery")
  airdata <<- rbind(airdata, mrow)
  unlink(temp)
  unlink(csv_file)}
airdata <- data.frame()
for (year in 2022:2000) {
  processdata(year)}

```



```{r}
summary(airdata)
# Days with AQI = number of days there are mesaurments of the AQI in that year
# Days Good = number of days where there was a good AQI, where AQI ranges from 0 to 50
# Days Modrate = number of days with AQI ranges from 51 to 100
# Unhealthy for Sensitive Groups = number of days with AQI ranges from 101 to 150
# Days Unhealthy = number of days where AQI ranges from 151 to 200
# Days Very Unhealthy = number of days where AQI ranges 201 t0 300
# Days Hazardous = number of days where AQI is 301 or higher (301 -500)
# AQI Max = highest daily aqi value in year
# AQI 90th percentile = 90% of daily AQI during the year were less than or equal to the 90th percentile
# AQI Median = Half of dailt AQI values during the year were less than or equal to the median value 
# Days CO, NO2, O3, PM2.5, PM10 = levels of pollutants responsible for the higher AQI value. Blank Cloumn  indicates a pollutant not measured in the county or CBSA (Core Based Statistical Areas(EPA))
```

```{r}
sum(is.na(airdata))
# there are no NA in this data set
```

```{r}
boxplot(airdata$`Max AQI`)
# very basic box plot to see the maxoimum AQI value from the past 20 years
```

```{r}
ggplot_boxplot(data = airdata, x = `Max AQI`) 
```



```{r}
ggplot(data = airdata, aes(x = Year, y = `Max AQI`)) + 
  geom_point() +
  labs(title = "Maximum AQI for the past 22 years",
       x = "Year",
       y = "AQI Value") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


# plot of the Max AQI recorded for each year

```



```{r}
ggplot(data = airdata, aes(x = Year, y = `Median AQI`)) + 
  geom_point() +
  labs(title = "Median AQI for the past 22 years",
       x = "Year",
       y = "AQI Value") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + geom_smooth()


# plot of the Median AQI recorded for each year 
```

```{r}
ggplot(data = airdata, aes(x = `Unhealthy for Sensitive Groups Days`, y = `Max AQI`)) + 
  geom_point() +
  labs(
       x = "number of unhealthy days",
       y = "Max AQI Value") 
```


```{r}
ctable <- table(airdata$`Median AQI`, airdata$`Unhealthy for Sensitive Groups Days`)
result <- chisq.test(ctable)
print(result)
```

```{r}

#fail to reject the null hypothesis which was that there higher aqi value would result in high numbers in unhealthy number if days for sensitive groups 
```

