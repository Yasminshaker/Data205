---
title: "Function for extracting airquality data "
author: "yasmin"
date: "2023-11-08"
output: html_document
---

```{r, message=FALSE}
processdata <- function(year)
  { zip_url <- paste0("https://aqs.epa.gov/aqsweb/airdata/annual_aqi_by_county_", year, ".zip")
  temp <- tempfile(fileext = ".zip")
  download.file(zip_url, temp)
  unzip(temp, exdir = tempdir())
  csv_file <- file.path(tempdir(), paste0("annual_aqi_by_county_", year, ".csv"))
  data <- readr::read_csv(csv_file)
  mrow <- data %>% filter(State == "Maryland" & County == "Montgomery")
  airdata <<- rbind(airdata, mrow)
  unlink(temp)
  unlink(csv_file)}
airdata <- data.frame()
for (year in 2022:2000) {
  processdata(year)}

```